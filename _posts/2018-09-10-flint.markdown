---
layout: post
title: "Feature Driven Developmentï¼ˆç‰¹æ€§é©±åŠ¨å¼€å‘)"
date: 2018-09-10 10:42:50 +0800
styles: [data-table]
comments: true
categories: æ¢ç´¢
author: [ç´«è–¯]
tags: [FDD]
---

## ä¸€ã€**Feature Driven Development**ï¼ˆç‰¹æ€§é©±åŠ¨å¼€å‘)

##### 1.**What** **do** **I** **mean** **by** **Feature** **Driven** **Development**?

ç®€è€Œè¨€ä¹‹ï¼šåœ¨ä½ çš„ä»£ç æœ¬èº«ä¸­åŒ…å«appéœ€è¦ç”¨åˆ°çš„ä¸€äº›ç‰¹æ€§å’Œæ“ä½œçš„ä¿¡æ¯ï¼Œä½¿ç”¨è¿™äº›ä¿¡æ¯æˆ‘ä»¬åªéœ€è¦é€šè¿‡æ·»åŠ ä¸€äº›å°‘é‡çš„ä»£ç å°±å¯ä»¥æ·»åŠ appéœ€è¦çš„å„ç§åŠŸèƒ½ã€‚è°ƒè¯•å’Œè¯Šæ–­æ•…éšœå˜å¾—æ›´åŠ å®¹æ˜“ï¼Œå› ä¸ºæ‚¨å¯ä»¥æ¸…æ¥šåœ°è¯†åˆ«ç”¨æˆ·åœ¨åšä»€ä¹ˆï¼Œè€Œä¸”å®ƒå¯ä»¥ä½¿åº”ç”¨ç¨‹åºçš„å†…éƒ¨ä½“ç³»ç»“æ„æ›´åŠ æ¸…æ™°ã€‚è¿™å¯ä»¥å¸®åŠ©å¼€å‘äº§å“çš„æ¯ä¸ªäººä½¿ç”¨ç›¸åŒçš„æœ¯è¯­ã€‚

##### 2.**Why** **is** **this** **useful?**

å®¢æˆ·ï¼š â€œåº”ç”¨ç¨‹åºå´©æºƒäº†ã€‚æˆ‘æ‰“ç®—ç»™ä½ ä¸€ä¸ªæ˜Ÿè¯„ä»·â€œ

å¼€å‘è€…ï¼š â€œæˆ‘å¾ˆæŠ±æ­‰ã€‚è¯·å‘Šè¯‰æˆ‘ä»¬ä½ åœ¨ç¢°æ’ä¸­é‡åˆ°äº†ä»€ä¹ˆï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥é‡ç°å®ƒå¹¶å¸®åŠ©ä½ â€œ

æˆ‘åœ¨å¼€å‘è¿‡ç¨‹ä¸­ä¼šé‡åˆ°è¿™æ ·çš„æƒ…å†µï¼Œå°½ç®¡æˆ‘ä»¬ç”¨äº†ç±»ä¼¼äºfabricè¿™æ ·çš„bugè¿½è¸ªæ—¥å¿—ï¼Œä½†è¿˜æ˜¯å¾ˆéš¾çŸ¥é“ç”¨æˆ·åœ¨åº”ç”¨ç¨‹åºä¸­åˆ°åº•åšäº†ä»€ä¹ˆã€‚æ‰€ä»¥å¦‚æœä»£ç èƒ½å¤Ÿæ›´å¥½åœ°äº†è§£ç”¨æˆ·åœ¨åŠŸèƒ½çº§åˆ«ä¸Šæ‰€åšçš„äº‹æƒ…æ—¶ï¼Œæˆ‘ä»¬å°†ä¼šå¾—åˆ°æ›´å¤šæœ‰ç”¨çš„ä¿¡æ¯ã€‚Feature Driven Developmentå°±æ˜¯å›´ç»•å…¶åŠŸèƒ½è®¾è®¡åº”ç”¨ç¨‹åºï¼Œä»¥åŠç”¨æˆ·åœ¨ä¸è¿™äº›åŠŸèƒ½äº¤äº’æ—¶æ‰§è¡Œçš„é«˜çº§æ“ä½œã€‚è¿™ä¸ªæƒ³æ³•å¹¶ä¸æ˜¯ç‰¹å®šäºä»»ä½•ä¸€ä¸ªå¹³å°æˆ–ç‰¹å®šç±»å‹çš„åº”ç”¨ç¨‹åºï¼Œä½†ä¼¼ä¹ç‰¹åˆ«é€‚åˆäºç§»åŠ¨å’Œæ¡Œé¢åº”ç”¨ç¨‹åºã€‚è‹¹æœå¹³å°å‘å¸ƒäº†ä¸€ä¸ªåä¸ºFlintçš„å¼€æºé¡¹ç›®ï¼Œå®ç°äº†è¿™äº›æƒ³æ³•ã€‚

##### 3.**The** **core** **concepts**

å½“ä½ å¢åŠ ä¸€ä¸ªåŠŸèƒ½çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šé‡åˆ°è¿™ä¸ªåŠŸèƒ½åœ¨æŸäº›æ¡ä»¶ä¸‹ä¸å¯ç”¨çš„çŠ¶å†µï¼Œæ¯”å¦‚ä¸€ä¸ªåšæ³•åŠŸèƒ½æˆ‘ä»¬è¦æ±‚å®ƒçš„æ·»åŠ å’Œç¼–è¾‘æ“ä½œéƒ½ä¸èƒ½ç”¨ï¼Œé€šå¸¸æˆ‘ä»¬ä¼šç¦æ‰æ·»åŠ å’Œç¼–è¾‘æŒ‰é’®ç‚¹å‡»äº‹ä»¶ã€‚**Feature Driven Development**å°†**Feature**ä½œä¸º**a first-class object**ï¼Œæˆ‘ä»¬ä¸ä»…å¯ä»¥æè¿°actionèƒ½ä¸èƒ½ç”¨ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æè¿°Featureèƒ½ä¸èƒ½ç”¨ï¼Œæ•´ä¸ªFeatureä¸èƒ½ç”¨çš„è¯ï¼ŒåŠŸèƒ½ç»‘å®šçš„æ“ä½œä¹Ÿå°±ä¸èƒ½ä½¿ç”¨ã€‚

FDDæœ‰å››ä¸ªåŸºæœ¬ç»„æˆéƒ¨åˆ†ï¼š**Feature, Action, Input and Presenter.**

featureåŠŸèƒ½æ˜¯äººä»¬å¯ä»¥ç”¨ä½ çš„åº”ç”¨ç¨‹åºæ¥åšçš„äº‹æƒ…ï¼ŒactionåŠ¨ä½œæ˜¯æ‚¨çš„ç¨‹åºå®é™…ä¸ºç”¨æˆ·ä½¿ç”¨åŠŸèƒ½æ‰€åšçš„äº‹æƒ…ã€‚å³ä½¿å¯¹äºä¸€ä¸ªå¾®ä¸è¶³é“çš„ç‰¹æ€§ï¼Œä¹Ÿæ€»æ˜¯éœ€è¦å¤šä¸ªæ“ä½œã€‚

featureåŠŸèƒ½æ˜¯æˆ‘ä»¬è®¾è®¡å’Œé”€å”®çš„ã€‚actionåŠ¨ä½œæ˜¯æˆ‘ä»¬åœ¨ä»£ç ä¸­â€œæ‰§è¡Œâ€åŠ¨ä½œä½¿åŠŸèƒ½å‘ç”Ÿï¼Œå¹¶é€šè¿‡FDDå·¥å…·(åˆ†æã€æ—¥å¿—ç­‰)è·Ÿè¸ªè¿™äº›åŠŸèƒ½ã€‚

ä¾‹å­ï¼š

- â€œæ–‡æ¡£ç¼–è¾‘â€æ˜¯ä¸€é¡¹é«˜çº§åŠŸèƒ½ã€‚å®ƒå¯èƒ½æœ‰è®¸å¤šå­åŠŸèƒ½ï¼Œä¾‹å¦‚â€œæ’å…¥å›¾ç‰‡â€ï¼Œâ€œæ‹¼å†™æ£€æŸ¥â€ã€‚(Features åŠŸèƒ½ç»„çš„æ¦‚å¿µ)
- â€œå‘å¸ƒæ¨æ–‡â€æ˜¯ä¸€é¡¹åŠŸèƒ½ï¼Œå…¶ä¸­åŒ…æ‹¬å¤šé¡¹æ“ä½œï¼Œä¾‹å¦‚â€œæ˜¾ç¤ºæ’°å†™UIâ€ï¼Œâ€œå¦å­˜ä¸ºè‰ç¨¿â€ï¼Œâ€œå–æ¶ˆâ€å’Œâ€œå‘å¸ƒâ€ã€‚å®ƒå¯èƒ½å…·æœ‰å­åŠŸèƒ½â€œé™„åŠ åª’ä½“â€ï¼Œå…¶æ“ä½œä¸ºâ€œæ˜¾ç¤ºåª’ä½“åº“â€ï¼Œâ€œé™„åŠ æ‰€é€‰åª’ä½“â€ï¼Œâ€œå…³é—­â€ã€‚ï¼ˆä¸€ä¸ªfeatureåŠŸèƒ½ç»‘å®šå¤šä¸ªactionï¼‰

æ²¡æœ‰ä¸¥æ ¼çš„è§„åˆ™ï¼Œä½ å¯ä»¥æ ¹æ®åˆ†å‰²åŠŸèƒ½çš„æ–¹å¼åšäº›é€‚åˆè‡ªå·±çš„è§„åˆ™ã€‚ä¼¼ä¹æœ‰æ•ˆçš„ä¸€èˆ¬è§„åˆ™æ˜¯ï¼š

å¦‚æœæ‚¨éœ€è¦å¤šä¸ªshow/dismissæ“ä½œï¼Œåˆ™å¯èƒ½éœ€è¦å°†è¿™äº›æ“ä½œæ‹†åˆ†ä¸ºå­åŠŸèƒ½

**Featureåœ¨ä»£ç ä¸­å®šä¹‰**

| å±æ€§å       |                             æè¿°                             |
| :----------- | :----------------------------------------------------------: |
| id           |           åŠŸèƒ½çš„å”¯ä¸€IDï¼Œä»¥ä¾¿å¯ä»¥åœ¨æ—¥å¿—ä¸­è½»æ¾è¯†åˆ«ã€‚           |
| name         |            ä¸€ä¸ªåŠŸèƒ½åç§°ï¼Œç”¨äºå‘å¼€å‘äººå‘˜å’ŒQAæ˜¾ç¤ºã€‚            |
| description  |               åŠŸèƒ½çš„æè¿°ï¼Œæ˜¾ç¤ºç»™å¼€å‘äººå‘˜å’ŒQAã€‚               |
| isAvailable  |                      è¯¥åŠŸèƒ½æ˜¯å¦å½“å‰å¯ç”¨                      |
| availability | ç¡®å®šè¯¥åŠŸèƒ½çš„å¯ç”¨æ€§çš„æŒ‡ç¤º-ä¾‹å¦‚éœ€è¦è¿è¡Œæ—¶æ£€æŸ¥ï¼ŒåŸºäºç”¨æˆ·åå¥½æˆ–è®¾ç½®éœ€è¦è´­ä¹° |
| actions      |                    æ­¤åŠŸèƒ½ä¸­å¯ç”¨åŠ¨ä½œçš„åˆ—è¡¨                    |
| variation    |                   å“ªç§A/Bæµ‹è¯•å˜ä½“ç›®å‰æœ‰æ•ˆ                    |

ä»¥ä¸Šåªæ˜¯ä¸€ä¸ªæŒ‡å—ï¼Œå®é™…ä¸Šç”±äºæ¡†æ¶è®¾è®¡çš„é™æ€ç‰¹æ€§ï¼ŒFlintä¸ä¸Šè¿°æœ‰ä¸€äº›åˆ†æ­§ï¼Œä»¥åˆ©ç”¨Swiftè¯­è¨€ç‰¹æ€§å®ç°ç¼–è¯‘æ—¶çš„å®‰å…¨æ€§ã€‚

ä¾‹å¦‚ï¼ŒFlintå°†ä¸æ€»æ˜¯å¯ç”¨çš„åŠŸèƒ½åˆ†éš”ä¸ºå•ç‹¬çš„ç±»å‹ConditionalFeatureã€‚å®ƒä»…å…·æœ‰è¯¥ç±»å‹çš„å¯ç”¨æ€§å±æ€§ï¼Œè¿™ä½¿å…¶èƒ½å¤Ÿæœ‰é€‰æ‹©åœ°æä¾›åœ¨éæ¡ä»¶æˆ–æ¡ä»¶ç‰¹å¾ä¸Šæœ‰é€‰æ‹©åœ°å¯ç”¨çš„å‡½æ•°ã€‚è¿™ä½¿å¾—åœ¨ä¸é¦–å…ˆæ£€æŸ¥ç‰¹å¾æ˜¯å¦å¯ç”¨çš„æƒ…å†µä¸‹ä¸å¯èƒ½æ‰§è¡Œæ¡ä»¶ç‰¹å¾çš„åŠ¨ä½œã€‚

Flintåœ¨Featureé‡Œä¹Ÿæ²¡æœ‰actionså±æ€§ï¼Œè€Œæ˜¯ä½¿ç”¨ç®€å•çš„ç‰¹å®šäºåŸŸçš„è¯­è¨€æ¥å£°æ˜Actionï¼Œä»¥ä¾¿åœ¨è°ƒç”¨Action inputå’ŒPresenterç±»å‹æ—¶å…·æœ‰ç¼–è¯‘æ—¶ç±»å‹å®‰å…¨æ€§ã€‚

**Actionåœ¨ä»£ç ä¸­å®šä¹‰**

| å±æ€§å                                |                             æè¿°                             |
| :------------------------------------ | :----------------------------------------------------------: |
| id                                    |           æ“ä½œçš„å”¯ä¸€IDï¼Œä»¥ä¾¿å¯ä»¥åœ¨æ—¥å¿—ä¸­è½»æ¾è¯†åˆ«ã€‚           |
| name                                  |            ä¸€ä¸ªæ“ä½œåç§°ï¼Œç”¨äºå‘å¼€å‘äººå‘˜å’ŒQAæ˜¾ç¤ºã€‚            |
| description                           |               æ“ä½œçš„æè¿°ï¼Œæ˜¾ç¤ºç»™å¼€å‘äººå‘˜å’ŒQAã€‚               |
| inputType                             |                      æ“ä½œæ‰€éœ€çš„è¾“å…¥ç±»å‹                      |
| presenterType                         |              æ“ä½œæ‰€éœ€çš„æ¼”ç¤ºè€…ç±»å‹ç”¨æ¥æä¾›è¾“å‡ºã€‚              |
| analyticsID                           | åˆ†æäº‹ä»¶IDæŠ¥å‘Šåˆ°åˆ†æåç«¯ï¼Œå¯é€‰çš„ï¼Œå› ä¸ºæœ‰äº›æ“ä½œä¸éœ€è¦åˆ†æäº‹ä»¶ |
| perform(input, presenter, completion) |                      å®é™…æ‰§è¡Œæ“ä½œçš„å‡½æ•°                      |

æ“ä½œå®ç°é€šå¸¸æ˜¯ç®€å•çš„é€»è¾‘ç‰‡æ®µï¼Œå®ƒä»¬å°†ä¸šåŠ¡é€»è¾‘ä»£ç ä¸­çš„æ‰€æœ‰ç»„ä»¶è¿æ¥åœ¨ä¸€èµ·ï¼Œè·å–è¾“å…¥å¹¶åœ¨å¿…è¦æ—¶æ˜¾ç¤ºæ“ä½œçš„ç»“æœã€‚

é€šå¸¸æ“ä½œå®ç°åªæœ‰å‡ è¡Œä»£ç :

```
if input is valid then

  call service to do the work, passing input

  call presenter to show results of the action

  call completion handler indicating success or failure

else

  call completion handler indicating failure
```



Inputæ˜¯æ‚¨çš„æ“ä½œæ‰€éœ€çš„ä»»ä½•ç±»å‹ï¼Œé€šå¸¸å°†å‡ æ¡ä¿¡æ¯æŠ˜å æˆå•ä¸ªåŒ…è£…ç±»å‹ï¼Œä¾‹å¦‚a structæˆ–classã€‚

Presenteræ˜¯ä½ å®šä¹‰çš„åŠ¨ä½œå¯ä»¥ç”¨å®ƒæ¥æä¾›è¾“å‡ºçš„ä»»ä½•ç±»å‹ã€‚ä½¿ç”¨è¿™äº›interfaceæˆ–åè®®ç±»å‹å°†å…è®¸æ‚¨å°†æ“ä½œä¸æ‰€æœ‰UIåˆ†ç¦»ï¼Œå¹¶ä½¿æ‚¨çš„åº”ç”¨ç¨‹åºçš„ä¸»è¦æ“ä½œéå¸¸å®¹æ˜“è¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œè€Œæ— éœ€å¯åŠ¨UIã€‚è¿™æ ·åšä¹Ÿä¼šä½¿æ‚¨çš„è¡Œä¸ºè·¨å¹³å°ã€‚

##### 4.**Putting** **it** **into** **practice**

å½“æ‚¨çš„åº”ç”¨éœ€è¦è°ƒç”¨æ“ä½œæ—¶ï¼Œå®ƒå¿…é¡»é¦–å…ˆéªŒè¯æ“ä½œçš„åŠŸèƒ½å½“å‰æ˜¯å¦å¯ç”¨ï¼Œç„¶åå°†è¾“å…¥å’Œæ¼”ç¤ºè€…ä¼ é€’ç»™æ“ä½œæœ¬èº«ã€‚å¦‚æœæ‚¨çŸ¥é“è¯¥åŠŸèƒ½å§‹ç»ˆå¯ç”¨ï¼Œåˆ™å¯ä»¥é¿å…æ­¤åŠŸèƒ½å¯ç”¨æ€§æ­¥éª¤ï¼Œä½†è¿™å–å†³äºæ‚¨çš„FDDå®æ–½ã€‚

æ‰§è¡ŒåŠ¨ä½œæ˜¯æœ€é‡è¦çš„æƒ³æ³•ï¼Œè¿™é‡Œæ˜¯ä¼ªä»£ç çš„ç®€å•è¡¨è¾¾ï¼š

```
if documentEditFeature is enabled then

  perform duplicateShapeAction with

    the current shape as input and

    the current view controller as presenter 
```

ä¸Šé¢çš„ä¼ªä»£ç éå¸¸é€‚åˆäºè‡ªåŠ¨åŒ–ä»»åŠ¡ï¼Œæ¯”å¦‚æŠ¥å‘Šåˆ†æï¼Œè·Ÿè¸ªç”¨æˆ·åœ¨è°ƒè¯•ä¸­åšäº†ä»€ä¹ˆï¼Œä»¥åŠç”¨æˆ·å¿…é¡»é¢å¤–ä»˜è´¹æ‰èƒ½äº«å—ç‰¹æ€§çš„è¿™ç§é˜»å¡æ€§åŠŸèƒ½ã€‚

![FDD action diagram.png](https://static1.squarespace.com/static/537d040fe4b0b9e2ae50b2aa/t/5ade364188251bfce4b0ac18/1524512328808/FDD+action+diagram.png?format=2500w)

FDDå¸®åŠ©æ‚¨çš„å›¢é˜Ÿåœ¨ç”Ÿæˆé«˜è´¨é‡åº”ç”¨ç¨‹åºæ‰€éœ€çš„æ•´ä¸ªâ€œå †æ ˆâ€ä¸­ä½¿ç”¨ç›¸åŒçš„åŠŸèƒ½å’Œæ“ä½œæœ¯è¯­ã€‚å½“è®¨è®ºä¸â€œæ‰“å¼€æ–‡ä»¶â€ç›¸å…³çš„é”™è¯¯æ—¶ï¼Œæ‚¨å®é™…åº”è¯¥å¾—åˆ°çš„é”™è¯¯æ˜¯ä¸â€œæ–‡æ¡£ç®¡ç†åŠŸèƒ½â€çš„â€œæ‰“å¼€æ–‡ä»¶æ“ä½œâ€æ˜æ˜¾ç›¸å…³çš„é”™è¯¯ã€‚æ‚¨çš„æµ‹è¯•è„šæœ¬å°†ä½¿ç”¨ç›¸åŒçš„è¯­è¨€â€¦å¹¶ä¸”é€šè¿‡FDDï¼Œæ‚¨çš„æ—¥å¿—ä¹Ÿå°†ä½¿ç”¨ç›¸åŒçš„è¯­è¨€ã€‚æ‚¨å¼€å§‹è€ƒè™‘åŠŸèƒ½å’Œæ“ä½œçš„äº§å“è®¾è®¡è¿‡ç¨‹ï¼Œå¹¶ä»é‚£é‡Œå¼€å§‹ç€æ‰‹ã€‚

##### 5.**What** **FDD** **gives** **you**

- åŠŸèƒ½æ ‡è®°ï¼ˆä¾‹å¦‚ï¼Œä»…åœ¨æŸäº›å†…éƒ¨ç‰ˆæœ¬æˆ–æŸäº›ç”¨æˆ·ä¸­å¯ç”¨æ–°åŠŸèƒ½ï¼‰

- è·Ÿè¸ªåˆ†æä»¥äº†è§£ç”¨æˆ·æ“ä½œ

- å¯ç”¨ç‰¹å®šåŠŸèƒ½çš„åº”ç”¨å†…è´­ä¹°å’Œè®¢é˜…

- ä»URLæ·±å…¥é“¾æ¥åˆ°åº”ç”¨ç¨‹åºçš„å†…å®¹

- è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹

- æ“ä½œç³»ç»Ÿé›†æˆï¼ˆä¾‹å¦‚Handoffï¼ŒSpotlight Searchï¼‰

- æä¾›A / Bæµ‹è¯•ï¼ˆä¸ºä¸åŒçš„ç”¨æˆ·ç¾¤æä¾›ä¸åŒçš„åŠŸèƒ½å˜ä½“ï¼‰

- è°ƒè¯•æ—¥å¿—è®°å½•å’Œå´©æºƒæŠ¥å‘Šï¼Œç»´æŠ¤ä¸ç”¨æˆ·æ“ä½œçš„æ˜ç¡®é“¾æ¥

- è®°å½•ç”¨æˆ·æ“ä½œâ€œæ—¶é—´è½´â€ï¼Œæ˜¾ç¤ºç”¨æˆ·æŒ‰é¡ºåºæ‰§è¡Œçš„æ‰€æœ‰æ“ä½œ

- æ”¹è¿›ç”šè‡³è‡ªåŠ¨åŒ–çš„æµ‹è¯•è®¡åˆ’

- ç”¨æˆ·è¡Œä¸ºåˆ†æï¼ˆç”¨æˆ·å¦‚ä½•ä½¿ç”¨æ‚¨çš„åº”ç”¨ï¼‰

- é€šè¿‡å°†UIä¸æ‰§è¡Œæ“ä½œçš„ä»£ç åˆ†ç¦»ï¼Œæ›´è½»æ¾åœ°å¯¹åŠŸèƒ½è¿›è¡Œå•å…ƒæµ‹è¯•

- ##### äº†è§£æ¯ä¸ªç”¨æˆ·ä½¿ç”¨æ¨¡å¼çš„é«˜çº§åŠŸèƒ½ã€‚æƒ³è±¡ä¸€ä¸‹ç”¨æˆ·åœ¨æ‚¨çš„åº”ç”¨ç¨‹åºä¸­å®Œæˆçš„æ“ä½œçš„æŒä¹…æ—¶é—´è¡¨ï¼Œèƒ½å¤Ÿåœ¨è¿è¡Œæ—¶æŸ¥è¯¢ä»¥å»ºè®®ä¸‹ä¸€æ­¥æ“ä½œæˆ–å°†æœºå™¨å­¦ä¹ åº”ç”¨äºå®ƒ

6.**Contextual** **Logging**

å¯ä»¥åŒ…æ‹¬å†™å…¥æ—¥å¿—è¾“å‡ºæ—¶çš„åŠŸèƒ½å’Œæ“ä½œã€‚å®ƒè¿˜å¯ä»¥åŒ…æ‹¬è¾“å…¥çš„æ–‡æœ¬æè¿°ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œæ‚¨å¯ä»¥åœ¨è¿è¡Œæ—¶æˆ–ä½œä¸ºäº‹åè°ƒæŸ¥çš„ä¸€éƒ¨åˆ†è¿‡æ»¤ç‰¹å®šåŠŸèƒ½çš„æ‰€æœ‰æ—¥å¿—è¾“å‡ºã€‚æ¯ä¸ªæ—¥å¿—æ¡ç›®çš„â€œä¸»é¢˜è·¯å¾„â€ æ˜¯åˆ†å±‚çš„ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œå…¶ä¸­åŒ…å«æœ‰å…³è§¦å‘å®ƒçš„åŠŸèƒ½å’Œæ“ä½œçš„ä¿¡æ¯çš„æ—¥å¿—è®°å½•ã€‚è¿™æ˜¯Flintæ¼”ç¤ºåº”ç”¨ç¨‹åºçš„ç®€åŒ–è¾“å‡ºï¼Œè¯¥åº”ç”¨ç¨‹åºå·²å¯ç”¨æ—¥å¿—è®°å½•ä»¥è·Ÿè¸ªæ‰€æœ‰æ“ä½œçš„å¼€å§‹å’Œå®Œæˆï¼Œå¹¶ä¸”å…·æœ‰â€œActivitiesFeatureâ€ï¼Œå¯è‡ªåŠ¨å°†æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„æˆåŠŸå®Œæˆçš„æ“ä½œå‘å¸ƒåˆ°æ“ä½œç³»ç»Ÿï¼Œä»¥è¿›è¡Œæœç´¢ç´¢å¼•ï¼š

```
16:56:02.687 DEBUG FlintDemo.AppFeatures/DocumentManagementFeature/#DocumentCreateAction | Starting
16:56:02.704 DEBUG FlintDemo.AppFeatures/DocumentManagementFeature/#DocumentCreateAction | Completed (success)
16:56:07.067 DEBUG FlintDemo.AppFeatures/DocumentManagementFeature/#DocumentSaveAction | Starting with input "How FDD Works.txt"
16:56:07.076 DEBUG FlintDemo.AppFeatures/DocumentManagementFeature/#DocumentSaveAction | Completed (success)
16:56:08.192 DEBUG FlintDemo.AppFeatures/DocumentManagementFeature/#DocumentOpenAction | Starting
16:56:08.199 DEBUG FlintDemo.AppFeatures/DocumentManagementFeature/#DocumentOpenAction | Completed (success)
16:56:08.261 DEBUG FlintCore.FlintFeatures/ActivitiesFeature/#PublishCurrentActionActivityAction | Setting user activity: Activity type: co.montanafloss.FlintDemo.document-open. Title:"How FDD Works.txt"
16:56:08.261 DEBUG FlintCore.FlintFeatures/ActivitiesFeature/#PublishCurrentActionActivityAction | End of breadcrumb trail
16:56:08.261 DEBUG FlintCore.FlintFeatures/ActivitiesFeature/#PublishCurrentActionActivityAction | Starting
16:56:08.262 DEBUG FlintCore.FlintFeatures/ActivitiesFeature/#PublishCurrentActionActivityAction | Completed (success)
```

[Flint](https://github.com/MontanaFlossCo/Flint)ä½¿ç”¨è¿™ä¸ªæä¾›äº†è‡ªå·±çš„ç§°ä¸ºâ€œFocusâ€çš„åŠŸèƒ½ï¼Œå¼€å‘äººå‘˜å¯ä»¥è°ƒç”¨ä¸€ä¸ªå‡½æ•°å°†ç‰¹å®šåŠŸèƒ½æ·»åŠ åˆ°â€œFocus Areaâ€ï¼Œå¹¶ä¸”**é™¤äº†è®°å½•ç»“æœå¤–**ï¼Œ**æ‰€æœ‰åº”ç”¨ç¨‹åºèŒƒå›´å†…çš„è®°å½•éƒ½è¢«ä»ä¸Šä¸‹æ–‡è®°å½•å™¨ä¸­è·å–å½“å‰å…³æ³¨çš„åŠŸèƒ½æˆ–å­åŠŸèƒ½**ã€‚è¿™å¯ä»¥åœ¨è¿è¡Œæ—¶æ›´æ”¹ï¼Œä»¥ç®€åŒ–è°ƒè¯•å¹¶æ¶ˆé™¤è·å–å…¨éƒ¨åº”ç”¨ç¨‹åºæ—¥å¿—è®°å½•çš„å†—æ‚æ„Ÿã€‚

##### 7.**your** **own** **implementations**

æˆ‘ä»¬å·²ç»ä»‹ç»äº†åŸºæœ¬çš„æ„å»ºæ¨¡å—:Features, Actions, Inputs and Presenters.

åœ¨æ„å»ºFlintæ—¶ï¼Œè¿˜å‡ºç°äº†ä¸€äº›å…¶ä»–æœ‰ç”¨çš„æ¦‚å¿µ

Feature Group â€” æœ‰ä¸€ç§ç‰¹æ®Šçš„åŠŸèƒ½ï¼Œå®ƒå¯ä»¥å…·æœ‰å­åŠŸèƒ½ï¼Œè¿™ä½¿æ‚¨èƒ½å¤Ÿæ„å»ºåŠŸèƒ½çš„å±‚æ¬¡ç»“æ„ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰è¿›è¡Œç‰¹å®šçš„åº”ç”¨ç¨‹åºå†…è´­ä¹°ï¼Œæ‚¨å¯ä»¥å¾ˆå®¹æ˜“åœ°ç¦ç”¨æ•´ä¸ªåŠŸèƒ½ç»„ã€‚

Action Session â€”ç”¨äºè°ƒç”¨æ“ä½œå¹¶æä¾›åˆ†ç»„ï¼Œä»¥ä¾¿åœ¨æ—¥å¿—ä¸­æ¸…æ¥šåœ°è¯†åˆ«å®ƒä»¬ï¼Œä»¥åŠå¼ºåˆ¶æ‰§è¡Œçº¿ç¨‹åˆåŒã€‚æ‚¨å¯ä»¥æƒ³è±¡ä¸€ä¸ªå¤šçª—å£åº”ç”¨ç¨‹åºæ¯ä¸ªæ‰“å¼€çš„æ–‡æ¡£æˆ–çª—å£ä¼šæœ‰ä¸€ä¸ªä¼šè¯ï¼Œä»¥åŠä¸€ä¸ªæˆ–å¤šä¸ªåå°ä¼šè¯ã€‚

Action Dispatcher -ä¼šè¯ä½¿ç”¨è°ƒåº¦ç¨‹åºå®é™…è°ƒç”¨æ“ä½œã€‚å®ƒæä¾›äº†ä¸€ä¸ªå•ç‹¬çš„ä½ç½®æ¥è§‚å¯Ÿæ‰€æœ‰ä¼šè¯ä¸­çš„æ‰€æœ‰è°ƒç”¨ï¼Œç”¨äºè‡ªåŠ¨æ—¥å¿—è®°å½•å’Œä¸æ“ä½œç›¸å…³çš„è¾…åŠ©ä½œç”¨ã€‚

Action Context â€”å®ƒä»¬åŒ…å«ä¸Šä¸‹æ–‡æ—¥å¿—è®°å½•å™¨ã€è¾“å…¥å’Œä¾¿åˆ©åŠŸèƒ½ï¼Œå¹¶åœ¨æ‰§è¡Œè¿™äº›åŠŸèƒ½æ—¶ä¼ é€’ç»™æ“ä½œã€‚

Contextual Logger -è¿™æ˜¯ä¸€ä¸ªç®€å•çš„æ—¥å¿—æ¥å£ï¼Œå®ƒç§æœ‰åœ°å­˜å‚¨æ¯ä¸ªåŠ¨ä½œè°ƒåº¦çš„ç‰¹æ€§å’ŒåŠ¨ä½œä¿¡æ¯ï¼Œä»¥åŠåŠ¨ä½œè¾“å…¥çš„æ–‡æœ¬è¡¨ç¤ºå’Œå…¶ä»–æœ‰ç”¨ä¿¡æ¯ã€‚åº•å±‚æ—¥å¿—å®ç°å®ç°ä¸Šä¸‹æ–‡æ—¥å¿—æ‰€éœ€çš„ä¸€åˆ‡ã€‚å®ƒè¢«ä¼ é€’ç»™æ“ä½œï¼Œè¿™æ ·å®ƒä»¬å°±å¯ä»¥æ‰§è¡Œç‰¹å®šäºä¸Šä¸‹æ–‡çš„æ—¥å¿—è®°å½•ï¼Œå¹¶å°†å…¶è½¬å‘ç»™å…¶ä»–å­ç³»ç»Ÿã€‚ 

![FDD Flint action diagra          m.png](https://static1.squarespace.com/static/537d040fe4b0b9e2ae50b2aa/t/5ae7235870a6adc56151e09b/1525097353900/FDD+Flint+action+diagra++++++++++m.png?format=2500w)æ›´å¤šè¯¦æƒ…å‚è€ƒï¼šhttp://www.montanafloss.co/blog/feature-driven-development


# åˆæ¢Flint

![Flint](https://d1qmdf3vop2l07.cloudfront.net/grand-badger.cloudvent.net/compressed/469a1a1d8e138e1fbf8e34792b40bf3f.svg)

**Flint**æ˜¯ä¸€ä¸ªç”¨**Swift**ç¼–å†™çš„åº”ç”¨ç¨‹åºæ¡†æ¶ï¼Œå®ƒå¸®åŠ©æ‚¨åˆ©ç”¨**Feature Driven Development**ï¼ˆç‰¹æ€§é©±åŠ¨å¼€å‘ï¼‰ä¸­çš„æƒ³æ³•ï¼Œä»ç‰¹æ€§å’Œæ“ä½œä¸­æ„å»ºåº”ç”¨ç¨‹åºã€‚

#### **ä¸€ã€ä½¿ç”¨**flint**èƒ½åšä»€ä¹ˆï¼Ÿ**

ä»¤äººæ„‰å¿«çš„ç”¨æˆ·ä½“éªŒæ„å‘³ç€å°†ä¸å¤§é‡çš„APIè¿›è¡Œäº¤äº’ã€‚æˆ‘ä»¬å¿…é¡»ä»”ç»†è¯·æ±‚æƒé™ï¼Œå¤„ç†åº”ç”¨å†…è´­ä¹°ï¼Œè·Ÿè¸ªä½¿ç”¨æƒ…å†µåˆ†æï¼Œå¹¶é€šè¿‡ç½‘å€ï¼Œé€šçŸ¥æˆ–Siriæ·±å…¥é“¾æ¥åˆ°æˆ‘ä»¬çš„åº”ç”¨ã€‚ä½¿ç”¨Flintï¼Œæ‚¨å¯ä»¥æ·»åŠ å°‘é‡ä»£ç æ¥æè¿°æ„æˆåº”ç”¨ç¨‹åºçš„åŠŸèƒ½å’Œæ“ä½œï¼Œå‰©ä¸‹çš„å°±äº¤ç»™flintæ¡†æ¶äº†ã€‚

#### äºŒã€å¦‚ä½•å°†Flinté›†æˆåˆ°æ‚¨çš„é¡¹ç›®ä¸­

1.ä¸ºäº†ä½¿ç”¨Flintï¼Œæ‚¨éœ€è¦æ„å»ºæ¡†æ¶å¹¶å°†å…¶åŠå…¶ä¾èµ–å…³ç³»æ·»åŠ åˆ°æ‚¨çš„é¡¹ç›®ä¸­ã€‚åœ¨ä½ è‡ªå·±çš„é¡¹ç›®ä¸­ä½¿ç”¨ Flint æœ€ç®€å•çš„æ–¹æ³•æ˜¯é€šè¿‡[Carthage](https://github.com/Carthage/Carthage)ã€‚æ‚¨å¯ä»¥åƒè¿™æ ·å°†ä¾èµ–é¡¹æ·»åŠ åˆ°æ‚¨çš„Cartfileä¸­:

```
github "MontanaFlossCo/Flint" "master"
```

2.ç„¶åè¿è¡Œ==carthage bootstrap==ï¼Œä¸ºæ‰€æœ‰å¹³å°æ„å»ºå®ƒã€‚å¯¹äºæ›´å¿«çš„æ„å»ºï¼Œæ‚¨å¯ä»¥é™åˆ¶åœ¨ä¸€ä¸ªå¹³å°ä¸Šï¼Œå¹¶ä½¿ç”¨ç¼“å­˜æ¥é¿å…é‡æ–°æ„å»ºï¼Œå¦‚æœæ²¡æœ‰å¯¹æ‚¨å·²ç»æ‹¥æœ‰çš„ç‰ˆæœ¬è¿›è¡Œæ›´æ”¹ï¼Œä¾‹å¦‚:

```
carthage bootstrap --platform iOS â€”cache-builds
```

3.å°†æ¡†æ¶æ·»åŠ åˆ°é¡¹ç›®ä¸­

3.1å°†FlintCore.frameworkä»./Carthage/Build/iOS(æˆ–ä»»ä½•ä½ çš„é¡¹ç›®éœ€è¦çš„å¹³å°æ–‡ä»¶å¤¹)æ‹–æ‹½åˆ°ä½ çš„app targetçš„Xcodeå¸¸è§„é€‰é¡¹å¡çš„â€œLinked Frameworks & Librariesâ€éƒ¨åˆ†

3.2å¦‚æœiOSéœ€è¦FlintUIï¼Œå¯¹è¿™ä¸ªFlintUIæ¡†æ¶åšåŒæ ·çš„æ“ä½œ

3.3.å¯¹ZIPFoundation.framework (Flintçš„ä¸€ä¸ªä¾èµ–åº“)ä¹ŸåšåŒæ ·çš„äº‹æƒ…

3.4åœ¨Build PhaseséªŒè¯è¿™äº›æ¡†æ¶æ˜¯å¦åˆ—åœ¨â€œLink Binary With Librariesâ€éƒ¨åˆ†

3.5ç¡®ä¿æ‚¨çš„é¡¹ç›®ä¸ºCarthageçš„å¤åˆ¶æ¡†æ¶æ„å»ºé˜¶æ®µæ­£ç¡®è®¾ç½®ã€‚å‚è§[Carthage Quick Setup](https://github.com/Carthage/Carthage#quick-start)

##### ä¸‰ã€åˆ›å»ºåŠŸèƒ½å’Œæ“ä½œ

å®šä¹‰ä½ çš„åº”ç”¨çš„åŠŸèƒ½å’Œä»–ä»¬æä¾›çš„æ“ä½œæ˜¯Flintå®ç°Feature Driven DevelopmentåŠŸèƒ½é©±åŠ¨å¼€å‘çš„åŸºæœ¬å‡ºå‘ç‚¹ã€‚

##### 1.å®šä¹‰æ‚¨çš„ç¬¬ä¸€ä¸ªç‰¹æ€§ç»„

æ‚¨çš„åº”ç”¨ç¨‹åºé€šå¸¸æœ‰ä¸€ä¸ªä¸»åŠŸèƒ½ç»„ï¼Œå®ƒå…·æœ‰åº”ç”¨ç¨‹åºæ”¯æŒçš„æ‰€æœ‰æ ¹çº§åŠŸèƒ½ã€‚åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶å°†å…¶è®¾ç½®ä¸ºFlintæ—¶å°†å…¶ä¼ é€’ã€‚

å®ƒæ˜¯ä¸€ä¸ªç±»ï¼Œæ‚¨å¯ä»¥æä¾›ä»»ä½•åç§°ï¼Œä½†é€šå¸¸æ‚¨ä¼šä½¿ç”¨ç±»ä¼¼AppFeaturesçš„ä¸œè¥¿ã€‚å®ƒåªéœ€è¦ç¬¦åˆFeatureGroupå¹¶å®šä¹‰ä¸€ç»„å­ç‰¹æ€§ã€‚

```
final class AppFeatures: FeatureGroup {                   
    static var description = "My main app features"      
    static var subfeatures: [FeatureDefinition.Type] = []
}   
```

                                                     

ä½ å¯ä»¥åœ¨å¯åŠ¨æ—¶è°ƒç”¨setupæˆ–quickSetupæ—¶ä½¿ç”¨æ­¤å‘½ä»¤:

```
funcapplication(_application:UIApplication,didFinishLaunc hingWithOptios launchOptions:                             [UIApplicationLaunchOptionsKey: Any]?) -> Bool {         
    Flint.quickSetup(AppFeatures.self)                                 
    â€¦                                                                   
}   
```

```
                                                                                                                      æ‚¨å¯ä»¥æ³¨å†Œå¤šä¸ªæ ¹çº§åˆ«çš„ç‰¹æ€§ç»„ï¼Œä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æœ‰ä¸€äº›æ¡†æ¶ä¹Ÿå…¬å¼€ç‰¹æ€§çš„è¯ã€‚ç”¨Flint.register()æ‰‹åŠ¨æ³¨å†Œè¿™äº›ã€‚æ‚¨åº”è¯¥åªè°ƒç”¨setup()æˆ–quickSetup()ä¸€æ¬¡ã€‚
```

##### 2.å®šä¹‰ä½ çš„ç¬¬ä¸€ä¸ªåŠŸèƒ½

ç°åœ¨æ‚¨å¯ä»¥å®šä¹‰ä¸€ä¸ªçœŸå®çš„ç‰¹æ€§ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°æ ¹ç‰¹æ€§çš„å­ç‰¹æ€§ä¸­ã€‚

ä¸€ä¸ªå¸¸è§„çš„ç‰¹æ€§æ€»æ˜¯å¯ç”¨çš„ï¼Œå®ƒä¸èƒ½è¢«å…³é—­ã€‚è¿™æ„å‘³ç€æ‚¨çš„ä»£ç å¯ä»¥å§‹ç»ˆæ‰§è¡Œå±äºå®ƒçš„æ“ä½œï¼Œè€Œæ— éœ€ä¸‰æ€ã€‚

```
class DocumentManagementFeature: Feature {              
    static let description = "Create, Open and Save       documentsâ€                                                       
    static func prepare(actions: FeatureActionsBuilder) {
    	// We'll add actions here soon                        
    }                                                    
 }  
```

æ³¨æ„ï¼šFeatureè¦å®ç°FeatureDefinitionåè®®ï¼Œæ¯ä¸ªç‰¹æ€§éƒ½æœ‰ä¸€ä¸ªXcodeé¡¹ç›®ç»„ï¼Œå…¶ä¸­åŒ…å«ç‰¹æ€§çš„.swiftæ–‡ä»¶ï¼Œä»¥åŠç‰¹æ€§æ‰€éœ€çš„å…¶ä»–ç±»å‹(å¦‚æ“ä½œå’Œæ¼”ç¤ºè€…)ã€‚ç°åœ¨æˆ‘ä»¬å¿…é¡»è¿”å›å¹¶ç¼–è¾‘åŠŸèƒ½ç»„ï¼Œä»¥åŠDocumentManagementFeatureè¿™ä¸ªåŠŸèƒ½çš„å­åŠŸèƒ½:

```
final class AppFeatures: FeatureGroup {                     
    static var description = "My main app featuresâ€      
    static var subfeatures: [FeatureDefinition.Type] = [ 
    	DocumentManagementFeature.self                        
    ]}   
```

#### #

##### 3.å®šä¹‰ä½ çš„ç¬¬ä¸€ä¸ªæ“ä½œ

ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªç‰¹æ€§ï¼Œè®©æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªåŠ¨ä½œã€‚Flintä¸­çš„ä¸€ä¸ªåŠ¨ä½œæ˜¯ä¸€å°å—é€»è¾‘ï¼Œå®ƒä»£è¡¨äº†åº”ç”¨ç¨‹åºå¯ä»¥åšçš„äº‹æƒ…â€”â€”é€šå¸¸æ˜¯å“åº”ä¸€äº›ç”¨æˆ·é©±åŠ¨çš„äº‹ä»¶æˆ–å¤–éƒ¨åˆºæ¿€(å¦‚æ¨é€é€šçŸ¥æˆ–ä½ç½®æ›´æ”¹)ã€‚æœ‰æ—¶å€™ï¼Œæ‚¨éœ€è¦çš„æ“ä½œä¸æ˜¯ç”±ç”¨æˆ·ç›´æ¥è°ƒç”¨çš„ï¼Œè€Œæ˜¯å¿…éœ€çš„ï¼Œå› ä¸ºæ‚¨éœ€è¦è·Ÿè¸ªåº”ç”¨ç¨‹åºä¸­å‘ç”Ÿçš„äº‹æƒ…ï¼Œæˆ–è€…éœ€è¦å“åº”URLã€‚

æ“ä½œæ¥æ”¶å•ä¸ªinputå’Œä¸€ä¸ªpresenterï¼Œactionå°†æ‰§è¡Œå·¥ä½œï¼Œç„¶åæ›´æ–°æ¼”ç¤ºç¨‹åºã€‚ inputæ˜¯æ‚¨åœ¨å®šä¹‰æ“ä½œæ—¶æŒ‡å®šçš„ä»»ä½•ç±»å‹ï¼Œ presenterä¹Ÿä¸€æ ·ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†ä½¿ç”¨Swiftå…³è”ç±»å‹çš„å¼ºå¤§åŠŸèƒ½ï¼Œå°†ä¼ é€’ç»™æ“ä½œçš„inputså’Œpresenters é™åˆ¶ä¸ºé‚£äº›ç±»å‹ã€‚

final class DocumentOpenAction: Action {                 

```
// Define the type of input this action expects       
typealias InputType = DocumentRef                    

// Define the type of presenter this action expects   
typealias PresenterType = DocumentPresenter          

static var description = "Open a documentâ€           
static func perform(with context:                     ActionContext<DocumentRef>, using presenter:               DocumentPresenter, completion: @escaping                                ((ActionPerformOutcome) -> ())) {                           
    presenter.openDocument(documentRef)                  
    completion(.success(closeActionStack: false))    
}                                                    
```

}   

è¿™é‡Œæˆ‘ä»¬éœ€è¦åšçš„æ˜¯æ¥æ”¶å¯¹æ–‡æ¡£çš„å¼•ç”¨ä½œä¸ºè¾“å…¥ï¼Œç„¶åå°†å…¶ä¼ é€’ç»™æ¼”ç¤ºè€…è¿›è¡Œæ˜¾ç¤ºã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œæ­¤æ—¶æˆ‘ä»¬å®é™…ä¸Šå¹¶æ²¡æœ‰åŠ è½½æ–‡æ¡£ã€‚

åŠ¨ä½œçš„performæ‰§è¡Œå‡½æ•°æ¥æ”¶ä¸Šä¸‹æ–‡ï¼Œå…¶ä¸­åŒ…æ‹¬è¾“å…¥å’Œå¯¹ç‰¹å®šä¸Šä¸‹æ–‡æ—¥å¿—è®°å½•å™¨çš„è®¿é—®ã€è¡¨ç¤ºå™¨å’Œå®Œæˆå›è°ƒã€‚æ³¨æ„ï¼Œæ‰§è¡Œå‡½æ•°å¿…é¡»ä½¿ç”¨InputTypeå’ŒPresenterTypeã€‚æ‰€ä»¥contextå‚æ•°å¿…é¡»æ˜¯ActionContext<â€¦ç”¨ç‰¹å®šçš„è¾“å…¥ç±»å‹æ›¿æ¢>ï¼Œæˆ–è€…å¦‚æœæ‚¨æ„¿æ„ï¼Œå¯ä»¥ä½¿ç”¨InputTypeåˆ«åã€‚ presenterçš„è®ºç‚¹ä¹Ÿæ˜¯å¦‚æ­¤ã€‚å¦‚æœè¿™äº›ç±»å‹ä¸åŒ¹é…ï¼Œæ‚¨å°†ä¼šå¾—åˆ°ä»¤äººå›°æƒ‘çš„Swiftç¼–è¯‘å™¨é”™è¯¯ã€‚

ä¸éœ€è¦è¾“å…¥çš„æ“ä½œå¿…é¡»ä½¿ç”¨NoInputä½œä¸ºå®ƒä»¬çš„InputTypeã€‚å¦‚æœä¸éœ€è¦ presenterï¼Œåˆ™å¿…é¡»ä½¿ç”¨NoPresenterä½œä¸ºæ¼”ç¤ºè€…ç±»å‹ã€‚è¿™äº›æ˜¯ç‰¹æ®Šçš„Flintç±»å‹ï¼Œå¯ä»¥è®©ä½ è¡¨æ˜ä½ ä¸éœ€è¦è¾“å…¥æˆ–æ¼”ç¤ºè€…ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªæ—¢æ²¡æœ‰è¾“å…¥ä¹Ÿæ²¡æœ‰æ¼”ç¤ºè€…çš„æ“ä½œç¤ºä¾‹:

```
final class BeepAction: Action {                            
    typealias InputType = NoInput                          
    typealias PresenterType = NoPresenter                     
    static func perform(with context:                      ActionContext<InputType>, using presenter: PresenterType, completion: @escaping ((ActionPerformOutcome) -> ())) {  
        print(â€œBeep!")                                    
        completion(.success(closeActionStack: false))    
    }                                                     
}   
```

                                                       

æ‚¨å°†æ³¨æ„åˆ°ï¼Œåœ¨ä¼ é€’ç»™å®Œæˆå¤„ç†ç¨‹åºçš„ç»“æœä¸Šè®¾ç½®äº†closeActionStackå‚æ•°ã€‚æ­¤æ ‡å¿—æŒ‡ç¤ºæ“ä½œæ˜¯å¦â€œå…³é—­â€åŠŸèƒ½ä¸Šçš„ä¸€ç³»åˆ—æ“ä½œï¼Œæ“ä½œå †æ ˆä½¿ç”¨è¿™äº›æ“ä½œã€‚ä¸€ä¸ªå®Œç¾çš„ä¾‹å­æ˜¯å…³é—­ä¸€ä¸ªæ–‡æ¡£ï¼Œä½ å¯ä»¥è®©Flintä¸¢å¼ƒæ“ä½œå †æ ˆã€‚



##### 4.å°†åŠ¨ä½œactionä¸åŠŸèƒ½ï¼ˆç‰¹æ€§ï¼‰featureç»‘å®š

ç°åœ¨æˆ‘ä»¬å¿…é¡»å°†æ“ä½œæ·»åŠ åˆ°ç‰¹æ€§ä¸­ï¼Œå› æ­¤æˆ‘ä»¬ä»å‰é¢ç¼–è¾‘ç‰¹æ€§å£°æ˜ï¼Œä¸ºæ“ä½œå’Œç‰¹æ€§çš„ç»‘å®šæ·»åŠ ä¸€ä¸ªé™æ€å±æ€§ï¼Œå¹¶é€šè¿‡å£°æ˜è¯¥æ“ä½œæ¥å‡†å¤‡ç‰¹æ€§ã€‚

```
class DocumentManagementFeature: Feature {               
    static let description = "Create, Open and Save       documentsâ€                                               
    static let openDocument =                              action(DocumentOpenAction.self)                           
    static func prepare(actions: FeatureActionsBuilder) {
        actions.declare(openDocument)                      
    }                                                    
 }  
```

                                                     

é¦–å…ˆï¼Œä¸Šé¢æ˜¾ç¤ºçš„é™æ€æ“ä½œå±æ€§ openDocumentè¡¨ç¤ºæ‚¨ä»¥åå°†è®¿é—®è¯¥actionå¹¶æ‰§è¡Œå®ƒã€‚å…¶æ¬¡ï¼Œå¿…é¡»ä¸ºæ“ä½œå€¼åˆ†é…action()å‡½æ•°çš„ç»“æœï¼Œå®ƒæ˜¯æ“ä½œå’Œç‰¹æ€§çš„ç»‘å®šã€‚æˆ‘ä»¬ä½¿ç”¨å®ƒæ¥çŸ¥é“å½“æ‚¨è°ƒç”¨è¯¥æ“ä½œæ—¶ï¼Œè¯¥æ“ä½œå±äºå“ªä¸ªç‰¹æ€§ã€‚

æœ€åï¼Œprepareå‡½æ•°å¿…é¡»è°ƒç”¨actions.declareï¼Œç”¨äºæ‰€æœ‰è¦ä½¿ç”¨çš„æ“ä½œã€‚æ‚¨å¯ä»¥è°ƒç”¨publishæ¥ä»£æ›¿å®ƒï¼Œå¦‚æœæ‚¨æœ‰æ˜¾ç¤ºåŠ¨ä½œçš„UI(ä¾‹å¦‚å¸¦æœ‰å·¥å…·é¢æ¿çš„ç»˜ç”»åº”ç”¨ç¨‹åº)ï¼Œåˆ™å°†å®ƒä»¬æ ‡è®°ä¸ºâ€œvisible to the userï¼ˆå¯¹ç”¨æˆ·å¯è§ï¼‰â€ã€‚

###### 5.è°ƒç”¨åŠŸèƒ½çš„æ“ä½œ

åœ¨æ‚¨çš„åº”ç”¨ä¸­ï¼Œæ‚¨éœ€è¦æ‰§è¡Œæ­¤æ“ä½œã€‚æ“ä½œåœ¨ä¸€ä¸ªå†…éƒ¨æ‰§è¡ŒActionSessionï¼Œå®ƒä¸ºæ‚¨çš„æ—¥å¿—è®°å½•å’Œè°ƒè¯•ä¸­çš„æ“ä½œæä¾›æ¦‚å¿µåˆ†ç»„ï¼ˆä¾‹å¦‚ï¼Œæ¯ä¸ªçª—å£ä¸€ä¸ªä¼šè¯ï¼Œæˆ–å½“å‰æ‰“å¼€çš„æ–‡æ¡£ï¼‰ï¼Œè·Ÿè¸ªæ“ä½œå †æ ˆå¹¶ç¡®ä¿çº¿ç¨‹å«ç”Ÿã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ“ä½œåœ¨ä¸»ä¼šè¯ä¸­æ‰§è¡ŒActionSession.mainï¼ŒæœŸæœ›åœ¨mainé˜Ÿåˆ—ä¸­è°ƒç”¨ã€‚å¦‚æœä½ ä¸åœ¨mainé˜Ÿåˆ—è°ƒç”¨å®ƒï¼Œå®ƒä¼šå´©æºƒï¼ŒfatalErroræŠ›å‡ºå´©æºƒä¿¡æ¯ã€‚

æ­£ç¡®ç¤ºä¾‹ï¼Œåœ¨è§†å›¾æ§åˆ¶å™¨çš„æŸå¤„ï¼Œä½ å¯ä»¥æ·»åŠ :

```
DocumentManagementFeature.openDocument.perform(using:self , with: document)   
```

è¿™é‡Œè¡¨ç¤ºè°ƒç”¨äº†æ–‡ä»¶ç®¡ç†åŠŸèƒ½ä¸‹çš„æ‰“å¼€æ–‡æ¡£æ“ä½œï¼Œusingå‚æ•°æ˜¯presenterï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨æˆ‘ä»¬çš„è¿™ä¸ªVCé‡Œéœ€è¦å®ç°DocumentPresenteråè®®ï¼Œwithæ˜¯inputï¼Œè¾“å…¥ç±»å‹æ˜¯document

å¦‚æœæ“ä½œä½¿ç”¨NoInputæˆ–NoPresenteræˆ–ä¸¤è€…éƒ½ä½¿ç”¨ï¼Œé‚£ä¹ˆåœ¨æ‰§è¡Œæ“ä½œæ—¶å¯ä»¥çœç•¥è¿™äº›å‚æ•°:

```
TestFeature.beep.perform()  
```

å¦‚ä¸Šæ‰€è¿°ï¼Œä¸Šé¢çš„è°ƒç”¨éƒ½æ˜¯åœ¨ main ActionSession è¿›è¡Œçš„ã€‚å¦‚æœæˆ‘ä»¬åœ¨åº”ç”¨ç¨‹åºä¸­æœ‰åå°å¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºå¦ä¸€ä¸ªActionSessionå¹¶åˆ†æ´¾åˆ°å®ƒï¼Œä½¿ç”¨ç¨å¾®ä¸åŒçš„è¯­æ³•:

```
// Do this at startup or "session setup" time, stash it   globally somewhere                                        
let bgProcessingSession = ActionSession(name: â€œbg",                                 userInitiatedActions: false,                                                    	callerQueue:     myBackgroundQueue)                                       
// Later on your background queueâ€                        
bgProcessionSession.perform(MachineLearningFeature.proces sImages, using: nil, with: imageStore) 
```

                   

##### 6.Conditional Features(æ¡ä»¶ç‰¹å¾)

å®šä¹‰ï¼šä»…åœ¨æ»¡è¶³æƒé™ï¼Œè´­ä¹°å’Œå…¶ä»–è¦æ±‚æ—¶æ‰ä½¿æ‚¨çš„åŠŸèƒ½å¯ç”¨

###### 6.1ä½¿ç”¨çº¦æŸå®šä¹‰æ¡ä»¶ç‰¹å¾

ç¬¬ä¸€æ­¥æ˜¯å°†æ‚¨çš„åŠŸèƒ½å®šä¹‰ä¸ºç¬¦åˆåè®®[`ConditionalFeature`](https://github.com/MontanaFlossCo/Flint/blob/master/FlintCore/Conditional%20Features/ConditionalFeature.swift)è€Œä¸æ˜¯`Feature`ã€‚ç„¶åï¼Œæ‚¨å¯ä»¥é€šè¿‡å®ç°è¯¥`constraints`å‡½æ•°æ¥å£°æ˜å¯¹è¯¥åŠŸèƒ½çš„çº¦æŸï¼Œè¯¥åŠŸèƒ½å°†å‘ŠçŸ¥Flintä½•æ—¶æ­¤åŠŸèƒ½åœ¨è¿è¡Œæ—¶å¯ç”¨ã€‚æ­¤å‡½æ•°åœ¨å¯åŠ¨æ—¶ä»…è°ƒç”¨ä¸€æ¬¡ã€‚

ä»¥ä¸‹æ˜¯Flintè‡ªå·±çš„æ·±åº¦é“¾æ¥æ”¯æŒæ¡ä»¶åŠŸèƒ½çš„ç¤ºä¾‹ï¼š

```
/// Flint's deep linking feature for URL Routes is conditional so that you can disable
/// it if you don't want it.
public class DeepLinkingFeature: ConditionalFeature {
    public static var description: String = "Deep Linking and app-URL handling"
	
    // Declare the constraints that must be met for
    // the feature to be available
    public static func constraints(requirements: FeatureConstraintsBuilder) {
    	requirements.runtimeEnabled()
    }

    // It's on by default. 
    public static var isEnabled: Bool? = true

    /// The action to use to perform the URL
    public static let performIncomingURL = action(PerformIncomingURLAction.self)
    
    public static func prepare(actions: FeatureActionsBuilder) {
        actions.declare(performIncomingURL)
    }
}
```

ä¸Šè¿°çº¦æŸ`.runtimeEnabled`æ„å‘³ç€`isEnabled`è¦ç´ çš„å±æ€§å¿…é¡»è¿”å›`true`æ‰èƒ½ä½¿è¯¥è¦ç´ å¯ç”¨ã€‚æ­¤å¤–ï¼ŒFlintæä¾›çš„é»˜è®¤å®ç°å§‹ç»ˆè¿”å›`true`ã€‚æ‚¨å¯ä»¥åœ¨è‡ªå·±çš„åŠŸèƒ½ä¸­è¦†ç›–è¯¥å±æ€§ï¼Œä»¥å…è®¸åœ¨ç¼–è¯‘æˆ–è¿è¡Œæ—¶åˆ†é…å®ƒï¼Œæˆ–è€…è°ƒç”¨å…¶ä»–ä»£ç ä»¥æŸ¥æ˜æ˜¯å¦åº”è¯¥å¯ç”¨å®ƒã€‚

æŸäº›çº¦æŸä¸ä¼šéšç€æ—¶é—´çš„æ¨ç§»è€Œæ”¹å˜å®ƒä»¬çš„å€¼ - ä¾‹å¦‚æœ€å°æ“ä½œç³»ç»Ÿç‰ˆæœ¬ - è€Œå…¶ä»–çº¦æŸåˆ™åœ¨è¿è¡Œæ—¶åœ¨éœ€è¦æ—¶è¿›è¡Œè¯„ä¼°ï¼Œå› ä¸ºå®ƒä»¬çš„çŠ¶æ€å¯ä»¥åœ¨åº”ç”¨ç¨‹åºè¿è¡Œæ—¶æ›´æ”¹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç”¨æˆ·è¿›è¡Œåº”ç”¨å†…è´­ä¹°ï¼Œåˆ™ä¸€æ—¦ç¡®è®¤è´­ä¹°æœ‰æ•ˆï¼Œç°åœ¨å°±å¯ä»¥è·å¾—ä¾èµ–äºè¯¥è´­ä¹°çš„åŠŸèƒ½ã€‚

###### 6.2å®šä¹‰å‰ææ¡ä»¶

æ”¯æŒä¸‰ç§å‰ç½®æ¡ä»¶åŠŸèƒ½ï¼š

- `purchase(requirement: PurchaseRequirement)` - è¯¥åŠŸèƒ½åœ¨è´­ä¹°ä¹‹å‰éœ€è¦ä¸€æ¬¡æˆ–å¤šæ¬¡è´­ä¹°ã€‚
- `runtimeEnabled()`- æ¯å½“è¯·æ±‚ä½¿ç”¨è¯¥åŠŸèƒ½æ—¶ï¼Œ`YourFeature.isEanbled`å°†æ£€æŸ¥å…¶å€¼ã€‚
- `userToggled(defaultValue: Bool)` - åŠŸèƒ½å°†æ£€æŸ¥ç”¨æˆ·çš„å½“å‰è®¾ç½®ä»¥æŸ¥çœ‹æ˜¯å¦å·²å¯ç”¨æ­¤åŠŸèƒ½ã€‚

```
let premiumSubscription = Product(name: "ğŸ’ Premium Subscription",
                                  description: "Unlock the level builder",
                                  productID: "SUB0001")
public class LevelBuilderFeature: ConditionalFeature {
    public static var description: String = "Premium Level Builder"
    public static func constraints(requirements: FeatureConstraintsBuilder) {
    	requirements.userToggled(defaultValue: true)
    	requirements.runtimeEnabled()   requirements.purchase(PurchaseRequirement(premiumSubscription))
    }
    static var isEnabled: Bool? = MyPlayerProgressTracker.shared.tutorialCompleted
    ...
}
```

###### 6.3å®šä¹‰æ‰€éœ€çš„æƒé™

è¦å£°æ˜æƒé™çº¦æŸï¼Œè¯·ä½¿ç”¨`permission()`æˆ–`permissions(...)`å‡½æ•°ï¼š

```
public class SelfieFeature: ConditionalFeature {
    public static var description: String = "Selfie Posting"
    public static func constraints(requirements: FeatureConstraintsBuilder) {
    	requirements.permissions(.camera,
                                 .photos,
                                 .location(usage: .whenInUse))
    }
    ...
}
```

è¯¥å‡½æ•°æè¿°äº†å½“ç”¨æˆ·ä½¿ç”¨ç›¸æœºæˆ–ç›¸å†Œçš„æ—¶å€™è¯·æ±‚ç”¨æˆ·æˆæƒ

###### 6.4å®šä¹‰å¹³å°é™åˆ¶

ä½¿ç”¨`.iOS`ï¼Œ`.watchOS`ï¼Œ`.tvOS`ï¼Œ`macOS`åœ¨æ„å»ºå™¨å±æ€§å¯ä»¥è®¾ç½®ä¸ºå¯ç”¨æ­¤åŠŸèƒ½æ‰€éœ€çš„æœ€å°ç‰ˆæœ¬ã€‚æ‚¨å¯ä»¥é€‰æ‹©å°†å…¶è®¾ç½®ä¸º`.any`ï¼Œæˆ–è€…`.unsupported`å¦‚æœæ‚¨æƒ³è¦é˜»æ­¢æŸä¸ªå¹³å°ä¸Šæ²¡æœ‰æ„ä¹‰çš„åŠŸèƒ½ã€‚æ‰€æœ‰å¹³å°çš„é»˜è®¤å€¼ä¸º`.any`ã€‚

```
public class ExampleFeature: ConditionalFeature {
    public static func constraints(requirements: FeatureConstraintsBuilder) {
    	requirements.iOS = 9
    	requirements.macOS = "10.12.1"
    	requirements.tvOS = .any
    	requirements.watchOS = .unsupported
    }
    ...
}
```

#### å››ã€è°ƒè¯•å·¥å…·

ç”¨äºåœ¨iOSä¸ŠæŸ¥çœ‹åŸºäºFlintçš„åº”ç”¨ç¨‹åºï¼Œä»¥éªŒè¯æ‚¨çš„åŠŸèƒ½å’Œæ“ä½œæ˜¯å¦å·²æ­£ç¡®è®¾ç½®ï¼Œæµè§ˆæ—¶é—´è½´å’Œç„¦ç‚¹æ—¥å¿—ä»¥æŸ¥æ‰¾é—®é¢˜ï¼Œç”Ÿæˆè°ƒè¯•æŠ¥å‘Šç­‰

##### 1.æ³¨å†ŒFlintUIåŠŸèƒ½

```
import FlintCore
import FlintUI
...
func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplicationLaunchOptionsKey: Any]?) -> Bool {
    Flint.quickSetup(FakeFeatures.self, domains: [], initialDebugLogLevel: .debug, initialProductionLogLevel: .info)
    // Add the FlintUI features
    Flint.register(FlintUIFeatures.self)
    ...
}
```

##### 2.åŠŸèƒ½æµè§ˆå™¨

æ­¤åŠŸèƒ½å…è®¸æ‚¨æ·±å…¥æŸ¥çœ‹åº”ç”¨ç¨‹åºä¸­å£°æ˜çš„æ‰€æœ‰åŠŸèƒ½çš„å±‚æ¬¡ç»“æ„ä»¥åŠå…¶æ“ä½œå£°æ˜ã€‚è¿™å¯¹äºè°ƒè¯•å’ŒéªŒè¯ä»£ç å·²æ­£ç¡®è®¾ç½®ä¸€åˆ‡éå¸¸æœ‰ç”¨ã€‚æ‚¨è¿˜å¯ä»¥æŸ¥çœ‹ç»™å®šç‰ˆæœ¬å’Œç”¨æˆ·é…ç½®æ–‡ä»¶ä¸­å½“å‰å¯ç”¨çš„åŠŸèƒ½ã€‚

```
let vc: UIViewController
vc = FeatureBrowserViewController.instantiate()
```

![Ã¦Â—Â¶Ã©Â—Â´Ã§ÂºÂ¿Ã¦ÂµÂÃ¨Â§ÂˆÃ¥Â™Â¨Ã¦ÂˆÂªÃ¥Â›Â¾](https://d1qmdf3vop2l07.cloudfront.net/grand-badger.cloudvent.net/compressed/6d8f4a8ffdd91be65e904647c46ecf95.png)

##### 3.æ—¶é—´çº¿æµè§ˆå™¨

æ­¤åŠŸèƒ½å°†æ˜¾ç¤ºæ—¶é—´è½´çš„å½“å‰å†…å®¹ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥æŸ¥çœ‹ç”¨æˆ·æ‰§è¡Œçš„æ“ä½œï¼Œå¹¶æ·±å…¥æŸ¥çœ‹å…¶è¯¦ç»†ä¿¡æ¯ï¼Œæ˜¾ç¤ºè¾“å…¥å’Œç›¸å…³å±æ€§ã€‚ 

```
let vc: UIViewController
vc = TimelineViewController.instantiate()
```

![Ã¦Â—Â¶Ã©Â—Â´Ã§ÂºÂ¿Ã¦ÂµÂÃ¨Â§ÂˆÃ¥Â™Â¨Ã¦ÂˆÂªÃ¥Â›Â¾](https://d1qmdf3vop2l07.cloudfront.net/grand-badger.cloudvent.net/compressed/75e510e5cf2588393a793754faa2ccbf.png)



##### 4.åŠ¨ä½œå †æ ˆæµè§ˆå™¨

æ­¤åŠŸèƒ½å…è®¸æ‚¨æŸ¥çœ‹åº”ç”¨ç¨‹åºä¸­æ´»åŠ¨çš„æ“ä½œï¼ŒæŒ‰ä¼šè¯å’Œå¯åŠ¨å †æ ˆçš„åŸå§‹åŠŸèƒ½è¿›è¡Œç»†åˆ†ã€‚

æ‚¨å¯ä»¥æ·±å…¥æŸ¥çœ‹å †æ ˆä»¥æŸ¥çœ‹åˆ°ç›®å‰ä¸ºæ­¢å·²å‘ç”Ÿçš„æ“ä½œï¼ŒåŒ…æ‹¬ç”¨æˆ·å¼€å§‹ä½¿ç”¨å…¶ä»–åŠŸèƒ½çš„å­å †æ ˆã€‚

```
let vc: UIViewController
vc = ActionStackListViewController.instantiate()
```

![Ã¦Â—Â¶Ã©Â—Â´Ã§ÂºÂ¿Ã¦ÂµÂÃ¨Â§ÂˆÃ¥Â™Â¨Ã¦ÂˆÂªÃ¥Â›Â¾](https://d1qmdf3vop2l07.cloudfront.net/grand-badger.cloudvent.net/compressed/ea37f8929741f4858654309fd13e3f1a.png)        

æ›´å¤šè¯¦æƒ…å‚è€ƒï¼šhttps://flint.tools

gitåœ°å€ï¼šhttps://github.com/MontanaFlossCo/FlintDemo-iOS
